<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Search Student - Smart Student Record Management System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <style>
    .search-container {
      max-width: 600px;
      margin: 0 auto;
    }
    .form-actions {
      display: flex;
      justify-content: center;
    }
    .card {
      text-align: center;
    }
    .form-grid {
      text-align: left;
    }
    .form-field {
      text-align: left;
    }
    .card-title, .card-subtitle {
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="logo">SMART STUDENT RECORD</div>
    <nav>
      <a href="homepage.html">Home</a>
      <a href="dashboard.html">Dashboard</a>
      <a href="add.html">Add / Edit</a>
      <a href="sortgrade.html">Sort Grades</a>
      <a href="search.html" style="color: #ffb347;">Search</a>
      <a href="enrollment.html">Enrollment Queue</a>
      <a href="undo.html">Undo</a>
    </nav>
  </header>

  <!-- HERO SECTION -->
  <section class="hero">
    <p class="hero-subtitle">Smart Student Record Management System</p>
    <h1 class="hero-title">Search Student</h1>
    <p class="hero-description">
      Find students quickly using Binary Search algorithm. Search by name or student ID.
    </p>
  </section>

  <!-- MAIN CONTENT -->
  <div class="main-content">
    <div class="search-container">
      <section>
        <!-- SEARCH STUDENT -->
        <div class="card">
          <div class="card-title">Search Student</div>
          <p class="card-subtitle">Search by name or student ID (Binary Search)</p>

          <form id="searchForm">
            <div class="form-grid">
              <div class="form-field">
                <label class="form-label">Search By</label>
                <div style="display: flex; justify-content: center; gap: 20px;">
                  <label style="font-size: 13px;">
                    <input type="radio" name="searchBy" value="name" checked /> Name
                  </label>
                  <label style="font-size: 13px;">
                    <input type="radio" name="searchBy" value="id" /> ID
                  </label>
                </div>
              </div>
              <div class="form-field">
                <label class="form-label">Input</label>
                <input type="text" id="searchInput" placeholder="Enter name or ID" required />
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn-primary">Search</button>
            </div>

            <div class="form-field" style="margin-top: 10px;">
              <label class="form-label">Result</label>
              <textarea id="searchResult" readonly>Enter search term and click Search.</textarea>
            </div>
          </form>
        </div>
      </section>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    Smart Student Record Management System (SRMS) â€¢ Data Structures &amp; Algorithms Project
  </footer>

  <script src="script.js"></script>
  <script>
    // Check if logged in
    if (!localStorage.getItem('loggedIn')) {
      window.location.href = 'logIn.html';
    }
    
    // Check if viewing all students
    const viewAllResults = localStorage.getItem('viewAllResults');
    if (viewAllResults) {
      document.getElementById('searchResult').value = viewAllResults;
      localStorage.removeItem('viewAllResults');
    }
    
    function calculateAverage(grades) {
      if (!grades || grades.length === 0) return 0;
      const sum = grades.reduce((a, b) => parseFloat(a) + parseFloat(b), 0);
      return (sum / grades.length).toFixed(2);
    }
    
    document.getElementById('searchForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const searchBy = document.querySelector('input[name="searchBy"]:checked').value;
      const searchTerm = document.getElementById('searchInput').value.trim().toLowerCase();
      
      if (!searchTerm) {
        alert('Please enter a search term.');
        return;
      }
      
      // Get students from localStorage
      const students = JSON.parse(localStorage.getItem('students') || '[]');
      
      // Sort students by name or ID for binary search
      let sortedStudents = [...students];
      if (searchBy === 'name') {
        sortedStudents.sort((a, b) => a.name.localeCompare(b.name));
      } else {
        sortedStudents.sort((a, b) => a.id.localeCompare(b.id));
      }
      
      // Binary Search
      let result = null;
      let left = 0;
      let right = sortedStudents.length - 1;
      
      while (left <= right) {
        const mid = Math.floor((left + right) / 2);
        const student = sortedStudents[mid];
        const compareValue = searchBy === 'name' ? student.name.toLowerCase() : student.id.toLowerCase();
        
        if (compareValue === searchTerm) {
          result = student;
          break;
        } else if (compareValue < searchTerm) {
          left = mid + 1;
        } else {
          right = mid - 1;
        }
      }
      
      // If exact match not found, try linear search for partial match
      if (!result) {
        result = students.find(s => {
          const searchValue = searchBy === 'name' ? s.name.toLowerCase() : s.id.toLowerCase();
          return searchValue.includes(searchTerm);
        });
      }
      
      const resultTextarea = document.getElementById('searchResult');
      if (result) {
        const avgGrade = calculateAverage(result.grades);
        resultTextarea.value = `Student Found:\nName: ${result.name}\nID: ${result.id}\nCourse: ${result.course}\nGrades: ${result.grades.join(', ')}\nAvg Grade: ${avgGrade}`;
      } else {
        resultTextarea.value = `Student not found.\nSearched for: ${searchTerm} (by ${searchBy})`;
      }
    });
  </script>
</body>
</html>

